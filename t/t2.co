Dr = require "../dr" .Dr

class Qr
  !(@dr) ->
  run: !(tag, ...args) ->
    if @last
      args.push @last
    @last = tag
    @dr.run tag, ...args

dr = new Dr
qr = new Qr dr

dr.run \x, (!(done) ->
  console.log \x
  done ()), \a, \b

qr.run \a, !(done) ->
  console.log \a
  done ()

qr.run \b, !(done) ->
  console.log \b
  done ()

qr.run \c, (!(done) ->
  console.log \c
  done ()), \x
